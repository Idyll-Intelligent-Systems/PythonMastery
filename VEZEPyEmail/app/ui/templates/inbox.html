{% extends "base.html" %}
{% block content %}
<div class="app">
  <div class="topbar">
    <div class="brand">✉️ VEZEPyEmail</div>
    <div class="search">
      <form method="get" action="/ui/inbox">
        <input name="q" value="{{ request.query_params.get('q') or '' }}" placeholder="Search mail" />
        <button class="btn secondary" type="submit">Search</button>
      </form>
    </div>
    <div class="actions">
      <button class="btn secondary">Refresh</button>
      <button class="btn">Compose</button>
    </div>
  </div>
  <div class="layout">
    <aside class="sidebar">
      <div class="compose"><button class="btn">+ Compose</button></div>
      <nav class="folders">
        <a class="folder active" href="#">Inbox</a>
        <a class="folder" href="#">Starred</a>
        <a class="folder" href="#">Sent</a>
        <a class="folder" href="#">Drafts</a>
        <a class="folder" href="#">Spam</a>
        <a class="folder" href="#">Trash</a>
      </nav>
    </aside>
    <section class="list">
      {% set messages = messages or [] %}
    {% for m in messages %}
    <a class="thread" href="/ui/message/{{m.id}}">
        <div class="avatar"></div>
        <div class="meta">
          <div class="row1"><span class="from">{{m.from}}</span><span class="date">{{m.date}}</span></div>
          <div class="subj">{{m.subject}}</div>
          <div class="snippet">{{m.snippet}}</div>
        </div>
        <div class="labels">
      {% for l in m.labels %}<span class="pill">{{l}}</span>{% endfor %}
        </div>
      </a>
      {% endfor %}
      {% if not messages %}
      <div class="thread">
        <div class="meta">Your inbox is empty</div>
      </div>
      {% endif %}
    </section>
    <section class="detail">
      <div class="msg-head"><div>Preview</div><div class="msg-tools"><button class="btn secondary">Archive</button><button class="btn secondary">Delete</button></div></div>
      <div class="msg-body">Select a message to read.</div>
    </section>
  </div>
  <div style="display:flex;gap:8px;justify-content:flex-end;padding:8px 16px;">
    {% set prev_offset = (request.query_params.get('offset')|int(default=0)) - 50 %}
    {% set next_offset = (request.query_params.get('offset')|int(default=0)) + 50 %}
    {% set q = request.query_params.get('q') %}
    {% if prev_offset >= 0 %}
    <a class="btn secondary" href="/ui/inbox?offset={{prev_offset}}{{'&q=' + q if q else ''}}">Prev</a>
    {% endif %}
    <a class="btn secondary" href="/ui/inbox?offset={{next_offset}}{{'&q=' + q if q else ''}}">Next</a>
  </div>
</div>
{% endblock %}
